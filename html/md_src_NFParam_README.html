<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>roboteam_ai: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">roboteam_ai
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A C++ library for defining and evaluating piecewise functions, inspired by the Web Audio API <a href="https://webaudio.github.io/web-audio-api/#AudioParam">AudioParam</a> interface.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Platform support</h2>
<p><code>NFParam</code> should compile and run on any platform with a C++11 compiler, but the following are tested in CI.</p>
<ul>
<li>[x] üì± iOS 9.0+</li>
<li>[x] üíª OS X 10.11+</li>
<li>[x] üêß Ubuntu Trusty 14.04+ (clang 3.9 or gcc 4.9)</li>
</ul>
<h2><a class="anchor" id="autotoc_md11"></a>
Raison D'√™tre :thought_balloon:</h2>
<p>When designing a cross platform player that could be used for complex mixing and effects, we required a library that worked in the same way that the Web Audio API <a href="https://webaudio.github.io/web-audio-api/#AudioParam">AudioParam</a> worked but on none web based platforms. This led to the creation of this library, which is not only able to emulate the <a href="https://webaudio.github.io/web-audio-api/#AudioParam">AudioParam</a> library but can also handle seeks into the centre of a function being evaluated due to its architecture not being a state machine. In addition to supporting everything <a href="https://webaudio.github.io/web-audio-api/#AudioParam">AudioParam</a> supports, we have also added in some extra goodies such as <code>smoothedYForXRange</code> and <code>cumulativeYForXRange</code>.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Architecture :triangular_ruler:</h2>
<p><code>NFParam</code> is designed as a C++11 interface to define a control curve and interact with it in real time. The API allows you to create a parameter and then begin to add control curves to execute at specific times. The library is thread safe and can be written or read from any thread. The system works by having a list of events, doing a binary search on that list to find the correct function to execute, then executing that function on the current time being requested.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Installation</h2>
<p>CMake 3.5 or later is required to generate the build. </p><div class="fragment"><div class="line">brew install cmake</div>
</div><!-- fragment --><p> or </p><div class="fragment"><div class="line">sudo apt-get install cmake</div>
</div><!-- fragment --><p><code>NFParam</code> is a <a href="https://cmake.org/">CMake</a> project, so to use it within a larger CMake project, simply add the following line to your <code>CMakeLists.txt</code> file: </p><div class="fragment"><div class="line">add_subdirectory(NFParam)</div>
</div><!-- fragment --><p> Alternatively, you can compile NFParam as a standalone library. The <a href="./ci">ci build scripts</a> can be used to install all necessary dependencies, build the library, and run unit tests.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
For Linux</h3>
<div class="fragment"><div class="line">sh ci/linux.sh build</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15"></a>
For iOS/OSX</h3>
<div class="fragment"><div class="line">sh ci/osx.sh build</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16"></a>
Examples</h2>
<h3><a class="anchor" id="autotoc_md17"></a>
Create the "Audio Param Example" curve pictured below</h3>
<h4><a class="anchor" id="autotoc_md18"></a>
Create the &lt;tt&gt;Param&lt;/tt&gt;</h4>
<p>Specify the default value, min, max, and a name. Until events are added, its value will be the default value for all times. </p><div class="fragment"><div class="line">auto p = nativeformat::param::createParam(0, 1, -1, &quot;testParam&quot;);</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md19"></a>
Add some events</h4>
<p>The <code>setYAtX</code> command behaves as a step function. The value specified will be maintained until the next event anchor. </p><div class="fragment"><div class="line">p-&gt;setYAtX(0.2f, 0.0);</div>
<div class="line">p-&gt;setYAtX(0.3f, 0.1);</div>
<div class="line">p-&gt;setYAtX(0.4f, 0.2);</div>
</div><!-- fragment --><p>The linearRampToYAtX event computes the slope necessary to reach the target value from the previous anchor point by the specified time. </p><div class="fragment"><div class="line">p-&gt;linearRampToYAtX(1.0f, 0.3);</div>
<div class="line">p-&gt;linearRampToYAtX(0.8f, 0.325);</div>
</div><!-- fragment --><p>The setTargetYAtX command will expoenentially approach the target value from the previous anchor with a rate specified by the time constant. It does not have a fixed end time. </p><div class="fragment"><div class="line">p-&gt;setTargetYAtX(0.5f, 0.325, time_constant);</div>
<div class="line">p-&gt;setYAtX(0.552f, 0.5);</div>
</div><!-- fragment --><p>The <code>exponentialRampToYAtX</code> event computes the constant necessary to reach the target value from the previous anchor point by the specified time. </p><div class="fragment"><div class="line">p-&gt;exponentialRampToYAtX(0.75f, 0.6);</div>
<div class="line">p-&gt;exponentialRampToYAtX(0.05f, 0.7);</div>
</div><!-- fragment --><p>The <code>setYCurveAtX</code> event linearly interpolates between the points provided on the user-defined curve. It cannot overlap with any other command anchors. </p><div class="fragment"><div class="line">size_t curve_len = 44100;</div>
<div class="line">std::vector&lt;float&gt; curve(curve_len);</div>
<div class="line">for (int i = 0; i &lt; curve_len; ++i) {</div>
<div class="line">  curve[i] = std::sin((3.14159265 * i) / curve_len);</div>
<div class="line">}</div>
<div class="line">p-&gt;setYCurveAtX(curve, 0.7, 0.3);</div>
</div><!-- fragment --> <h4><a class="anchor" id="autotoc_md20"></a>
Retrieve some values from the &lt;tt&gt;Param&lt;/tt&gt;</h4>
<p>Finally, let's sample some values from the param we have defined! </p><div class="fragment"><div class="line">size_t points = 1001;</div>
<div class="line">std::vector&lt;float&gt; x(points), y(points);</div>
<div class="line">p-&gt;yValuesForXRange(y.data(), points, 0.0, 1.0);</div>
<div class="line"> </div>
<div class="line">double ts = 1.0 / (points - 1);</div>
<div class="line">double t = 0;</div>
<div class="line">for (int i = 0; i &lt; x.size(); ++i) {</div>
<div class="line">  x[i] = t;</div>
<div class="line">  t += ts;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md21"></a>
Tests</h2>
<p><a href="source/test/NFParamTests.cpp"><code>NFParamTests.cpp</code></a> contains a number of test cases, two of which generate TSV output files that should match the <a href="https://webaudio.github.io/web-audio-api/#example1-AudioParam">AudioParam automation example</a> from the WAA spec. In the <code>resources</code> directory, there is a <a href="resources/plot.sh">script</a> that will plot the unit test output data if you have <a href="http://gnuplot.info/">gnuplot</a> installed. The path where <code>paramAutomation.txt</code> is generated when the tests are run by the ci scripts varies by platform.</p>
<h3><a class="anchor" id="autotoc_md22"></a>
Generating a plot</h3>
<div class="fragment"><div class="line">sh plot.sh ../build/source/test/Debug/paramAutomation.txt out.png</div>
</div><!-- fragment --><p> <img src="resources/paramAutomationExpected.png?raw=true" alt="" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md23"></a>
Contributing :mailbox_with_mail:</h2>
<p>Contributions are welcomed, have a look at the CONTRIBUTING.md document for more information.</p>
<h2><a class="anchor" id="autotoc_md24"></a>
License :memo:</h2>
<p>The project is available under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a> license.</p>
<h3><a class="anchor" id="autotoc_md25"></a>
Acknowledgements</h3>
<ul>
<li>Icon in readme banner is ‚Äú<a href="https://thenounproject.com/search/?q=parameter&amp;i=1477820">Settings</a>‚Äù by Bharat from the Noun Project.</li>
</ul>
<h4><a class="anchor" id="autotoc_md26"></a>
Contributors</h4>
<ul>
<li><a href="https://github.com/astrocox">Julia Cox</a></li>
<li><a href="https://github.com/jsarma">Justin Sarma</a></li>
<li><a href="https://github.com/drubinstein">David Rubinstein</a></li>
<li><a href="https://github.com/8W9aG">Will Sackfield</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
